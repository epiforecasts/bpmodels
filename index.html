<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Simulating and Analysing Transmission Chain Statistics using Branching Process Models • bpmodels</title>
<script src="katex-auto.js"></script><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><link href="deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Simulating and Analysing Transmission Chain Statistics using Branching Process Models">
<meta name="description" content="Provides methods to simulate and analyse the size and length of branching processes with an arbitrary offspring distribution. These can be used, for example, to analyse the distribution of chain sizes or length of infectious disease outbreaks, as discussed in Farrington et al. (2003) &lt;doi:10.1093/biostatistics/4.2.279&gt;.">
<meta property="og:description" content="Provides methods to simulate and analyse the size and length of branching processes with an arbitrary offspring distribution. These can be used, for example, to analyse the distribution of chain sizes or length of infectious disease outbreaks, as discussed in Farrington et al. (2003) &lt;doi:10.1093/biostatistics/4.2.279&gt;.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">bpmodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/bpmodels.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Theory &amp; literature</h6></li>
    <li><a class="dropdown-item" href="articles/theoretical_background.html">Theoretical background for bpmodels</a></li>
    <li><a class="dropdown-item" href="articles/branching_process_literature.html">Literature on branching process applications</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Modelling</h6></li>
    <li><a class="dropdown-item" href="articles/projecting_incidence.html">Projecting infectious disease incidence: a COVID-19 example</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/epiforecasts/bpmodels/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="bpmodels-methods-for-simulating-and-analysing-the-size-and-length-of-transmission-chains-from-branching-process-models">
<em>bpmodels</em>: Methods for simulating and analysing the size and length of transmission chains from branching process models<a class="anchor" aria-label="anchor" href="#bpmodels-methods-for-simulating-and-analysing-the-size-and-length-of-transmission-chains-from-branching-process-models"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<blockquote>
<p><a href="https://github.com/epiforecasts/bpmodels" class="external-link">bpmodels</a> is now <em>retired and will no longer be maintained</em>. We recommend using <a href="https://github.com/epiverse-trace/epichains" class="external-link"><code>{epichains}</code></a> instead. If you need help converting your code to use <code>{epichains}</code>, please <a href="https://github.com/epiverse-trace/epichains/discussions" class="external-link">open a discussion on epichains</a>.</p>
</blockquote>
<p><em>bpmodels</em> is an R package to simulate and analyse the size and length of branching processes with a given offspring distribution. These models are often used in infectious disease epidemiology, where the chains represent chains of transmission, and the offspring distribution represents the distribution of secondary infections caused by an infected individual.</p>
</div>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<p>The latest development version of the <em>bpmodels</em> package can be installed via</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check whether {pak} is installed</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://pak.r-lib.org/" class="external-link">"pak"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span><span class="st">"epiforecasts/bpmodels"</span><span class="op">)</span></span></code></pre></div>
<p>To load the package, use</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/epiforecasts/bpmodels" class="external-link">"bpmodels"</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Note: bpmodels is now retired and replaced by epichains. All features from bpmodels are available in epichains. Get epichains from &lt;https://github.com/epiverse-trace/epichains&gt;.Thank you for your support!</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="core-functionality">Core functionality<a class="anchor" aria-label="anchor" href="#core-functionality"></a>
</h1>
<p><em>bpmodels</em> provides three main functions:</p>
<p><code><a href="reference/chain_ll.html">chain_ll()</a></code>: calculates the likelihoods of observing a vector of chains of given sizes or lengths.</p>
<p>Here is a quick example of estimating the loglikelihood of an observed chain:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># example of observed chain sizes</span></span>
<span><span class="va">chain_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span> </span>
<span><span class="co"># estimate loglikelihood of the observed chain sizes</span></span>
<span><span class="va">chain_ll_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/chain_ll.html">chain_ll</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">chain_sizes</span>, offspring <span class="op">=</span> <span class="st">"pois"</span>, </span>
<span>                        stat <span class="op">=</span> <span class="st">"size"</span>, lambda <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="va">chain_ll_eg</span></span>
<span><span class="co">#&gt; [1] -7.772589</span></span></code></pre></div>
<p><code><a href="reference/chain_sim.html">chain_sim()</a></code>: simulates transmission chains until all chains stop producing offspring.</p>
<p>Below is a quick example where we simulate the chain sizes of <span class="math inline">5</span> chains with a poisson offspring with mean, <span class="math inline">\text{lambda} = 0.5</span>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chain_sim_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/chain_sim.html">chain_sim</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">5</span>, offspring <span class="op">=</span> <span class="st">"pois"</span>, stat <span class="op">=</span> <span class="st">"size"</span>, </span>
<span>                          lambda <span class="op">=</span> <span class="fl">0.5</span>, tree <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">chain_sim_eg</span><span class="op">)</span></span>
<span><span class="co">#&gt;   n id ancestor generation</span></span>
<span><span class="co">#&gt; 1 1  1       NA          1</span></span>
<span><span class="co">#&gt; 2 2  1       NA          1</span></span>
<span><span class="co">#&gt; 3 3  1       NA          1</span></span>
<span><span class="co">#&gt; 4 4  1       NA          1</span></span>
<span><span class="co">#&gt; 5 5  1       NA          1</span></span>
<span><span class="co">#&gt; 6 2  2        1          2</span></span></code></pre></div>
<p><code><a href="reference/chain_sim_susc.html">chain_sim_susc()</a></code>: simulates transmission chains from a specified population size with pre-existing immunity until the susceptible pool runs out.</p>
<p>Below is a quick example where we simulate chains with a poisson offspring with mean, <span class="math inline">\text{lambda} = 0.5</span>, and serial interval of <span class="math inline">3</span>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">chain_sim_susc_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/chain_sim_susc.html">chain_sim_susc</a></span><span class="op">(</span>pop <span class="op">=</span> <span class="fl">1000</span>, offspring <span class="op">=</span> <span class="st">"pois"</span>,</span>
<span>                                    mn_offspring <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                                    serial <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span><span class="fl">3</span><span class="op">}</span></span>
<span>                                    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">chain_sim_susc_eg</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id ancestor generation time</span></span>
<span><span class="co">#&gt; 1  1       NA          1    0</span></span></code></pre></div>
<p>See the <a href="https://epiverse-trace.github.io/bpmodels/articles/bpmodels.html" class="external-link">“Get started vignette”</a> for a detailed illustration of each function.</p>
<div class="section level2">
<h2 id="package-vignettes">Package vignettes<a class="anchor" aria-label="anchor" href="#package-vignettes"></a>
</h2>
<p>Specific use cases of <em>bpmodels</em> can be found in the <a href="https://epiverse-trace.github.io/bpmodels/" class="external-link">online documentation as package vignettes</a>, under “Articles”.</p>
</div>
<div class="section level2">
<h2 id="reporting-bugs">Reporting bugs<a class="anchor" aria-label="anchor" href="#reporting-bugs"></a>
</h2>
<p>To report a bug please open an <a href="https://github.com/epiverse-trace/bpmodels/issues/new/choose" class="external-link">issue</a>.</p>
</div>
<div class="section level2">
<h2 id="contribute">Contribute<a class="anchor" aria-label="anchor" href="#contribute"></a>
</h2>
<p>We welcome contributions to enhance the package’s functionalities. If you wish to do so, please follow the <a href="https://github.com/epiverse-trace/bpmodels/blob/main/.github/CONTRIBUTING.md" class="external-link">package contributing guide</a>.</p>
</div>
<div class="section level2">
<h2 id="code-of-conduct">Code of conduct<a class="anchor" aria-label="anchor" href="#code-of-conduct"></a>
</h2>
<p>Please note that the <em>bpmodels</em> project is released with a <a href="https://github.com/epiverse-trace/.github/blob/main/CODE_OF_CONDUCT.md" class="external-link">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
<div class="section level2">
<h2 id="citing-this-package">Citing this package<a class="anchor" aria-label="anchor" href="#citing-this-package"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"bpmodels"</span><span class="op">)</span></span>
<span><span class="co">#&gt; To cite package bpmodels in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Sebastian Funk, Flavio Finger, and James M. Azam (2023). bpmodels:</span></span>
<span><span class="co">#&gt;   Analysing transmission chain statistics using branching process</span></span>
<span><span class="co">#&gt;   models, website: https://github.com/epiverse-trace/bpmodels/</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   @Manual{,</span></span>
<span><span class="co">#&gt;     title = {bpmodels: Analysing transmission chain statistics using branching process models},</span></span>
<span><span class="co">#&gt;     author = {{Sebastian Funk} and {Flavio Finger} and {James M. Azam}},</span></span>
<span><span class="co">#&gt;     year = {2023},</span></span>
<span><span class="co">#&gt;     url = {https://github.com/epiverse-trace/bpmodels/},</span></span>
<span><span class="co">#&gt;   }</span></span></code></pre></div>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/epiforecasts/bpmodels/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/epiforecasts/bpmodels/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing bpmodels</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>James M. Azam <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/https://orcid.org/0000-0001-5782-7330" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Flavio Finger <br><small class="roles"> Author </small> <a href="https://orcid.org/https://orcid.org/0000-0002-8613-5170" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Sebastian Funk <br><small class="roles"> Author, copyright holder </small> <a href="https://orcid.org/https://orcid.org/0000-0002-2842-3406" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by James M. Azam, Flavio Finger, Sebastian Funk.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
