<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="bpmodels">
<title>Projecting infectious disease incidence: a COVID-19 example • bpmodels</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Projecting infectious disease incidence: a COVID-19 example">
<meta property="og:description" content="bpmodels">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">bpmodels</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/bpmodels.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Theory &amp; literature</h6>
    <a class="dropdown-item" href="../articles/theoretical_background.html">Theoretical background for bpmodels</a>
    <a class="dropdown-item" href="../articles/branching_process_literature.html">Literature on branching process applications</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Modelling</h6>
    <a class="dropdown-item" href="../articles/projecting_incidence.html">Projecting infectious disease incidence: a COVID-19 example</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/bpmodels/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Projecting infectious disease incidence: a COVID-19 example</h1>
                        <h4 data-toc-skip class="author">James Azam, Sebastian Funk</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/bpmodels/blob/HEAD/vignettes/projecting_incidence.Rmd" class="external-link"><code>vignettes/projecting_incidence.Rmd</code></a></small>
      <div class="d-none name"><code>projecting_incidence.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Branching processes can be used to project infectious disease trends in time
provided we can characterize the distribution of times between
successive cases (serial interval), and the distribution of secondary cases
produced by a single individual (offspring distribution). Such simulations can
be achieved in <em>bpmodels</em> with the <code><a href="../reference/chain_sim.html">chain_sim()</a></code> function and <span class="citation">Pearson et al. (<a href="#ref-pearson2020" role="doc-biblioref">2020</a>)</span>, and
<span class="citation">Abbott et al. (<a href="#ref-abbott2020" role="doc-biblioref">2020</a>)</span> illustrate its application to COVID-19.</p>
<p>The purpose of this vignette is to use early data on COVID-19 in South Africa
<span class="citation">(<a href="#ref-marivate2020" role="doc-biblioref">Marivate and Combrink 2020</a>)</span> to illustrate how <em>bpmodels</em> can be used to forecast an
outbreak.</p>
<p>Let’s load the required packages</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/epiverse-trace/bpmodels" class="external-link">"bpmodels"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://dplyr.tidyverse.org" class="external-link">"dplyr"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://lubridate.tidyverse.org" class="external-link">"lubridate"</a></span><span class="op">)</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>Included in <em>bpmodels</em> is a cleaned time series of the first 15 days of
the COVID-19 outbreak in South Africa. This can be loaded into
memory as follows:</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"covid19_sa"</span>, package <span class="op">=</span> <span class="st">"bpmodels"</span><span class="op">)</span></span></code></pre></div>
</details><p>Let us examine the first 6 entries of the dataset.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">covid19_sa</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   date       cases</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2020-03-05     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2020-03-07     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2020-03-08     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2020-03-09     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2020-03-11     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2020-03-12     3</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="setting-up-the-inputs">Setting up the inputs<a class="anchor" aria-label="anchor" href="#setting-up-the-inputs"></a>
</h2>
<div class="section level3">
<h3 id="onset-times">Onset times<a class="anchor" aria-label="anchor" href="#onset-times"></a>
</h3>
<p><code><a href="../reference/chain_sim.html">chain_sim()</a></code> requires a vector of onset times, <code>t0</code>, for each
chain/individual/simulation.</p>
<p>The <code>covid19_sa</code> dataset above is aggregated, so we will have to disaggregate
it into a linelist with each row representing a case and their onset time.</p>
<p>To achieve this, we will first use the date of the index case as the reference
and find the difference between each date and the reference.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">days_since_index</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">covid19_sa</span><span class="op">$</span><span class="va">date</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">covid19_sa</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">days_since_index</span></span>
<span><span class="co">#&gt;  [1]  0  2  3  4  6  7  8  9 10 11 12 13 14 15</span></span></code></pre></div>
</details><p>Using the vector of start times for the time series, we will then
create the linelist by disaggregating the time series so
that each case has a corresponding start time.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start_times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span></span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">x</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">y</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">1</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">days_since_index</span>,</span>
<span>  <span class="va">covid19_sa</span><span class="op">$</span><span class="va">cases</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">start_times</span></span>
<span><span class="co">#&gt;   [1]  0  2  3  4  4  4  4  6  6  6  6  6  6  7  7  7  8  8  8  8  8  8  8  8  9</span></span>
<span><span class="co">#&gt;  [26]  9  9  9  9  9  9  9  9  9  9  9  9  9 10 10 10 10 10 10 10 10 10 10 10 10</span></span>
<span><span class="co">#&gt;  [51] 10 11 11 11 11 11 11 11 11 11 11 11 12 12 12 12 12 12 12 12 12 12 12 12 12</span></span>
<span><span class="co">#&gt;  [76] 12 12 12 12 12 12 12 12 12 12 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13</span></span>
<span><span class="co">#&gt; [101] 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 13 14 14 14 14 14 14 14 14 14</span></span>
<span><span class="co">#&gt; [126] 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14 14</span></span>
<span><span class="co">#&gt; [151] 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15</span></span>
<span><span class="co">#&gt; [176] 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15 15</span></span>
<span><span class="co">#&gt; [201] 15 15</span></span></code></pre></div>
</details>
</div>
<div class="section level3">
<h3 id="serial-interval">Serial interval<a class="anchor" aria-label="anchor" href="#serial-interval"></a>
</h3>
<p>The log-normal distribution is commonly used in epidemiology to characterise
quantities such as the serial interval because it has a large variance
and can only be positive-valued <span class="citation">(<a href="#ref-nishiura2007" role="doc-biblioref">Nishiura 2007</a>; <a href="#ref-limpert2001" role="doc-biblioref">Limpert, Stahel, and Abbt 2001</a>)</span>.</p>
<p>In this example, we will assume based on COVID-19 literature that the
serial interval, S, is log-normal distributed with parameters,
<span class="math inline">\(\mu = 4.7\)</span> and <span class="math inline">\(\sigma = 2.9\)</span> <span class="citation">(<a href="#ref-pearson2020" role="doc-biblioref">Pearson et al. 2020</a>)</span>. Note that when the distribution
is described this way, it means <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> are the expected value
and standard deviation of the natural logarithm of the serial interval. Hence,
in order to sample the “back-transformed” measured serial interval with
expectation/mean, <span class="math inline">\(E[S]\)</span> and standard deviation, <span class="math inline">\(SD [S]\)</span>,
we can use the following parametrisation:</p>
<p><span class="math display">\[\begin{align}
E[S] &amp;= \ln \left( \dfrac{\mu^2}{(\sqrt{\mu^2 + \sigma^2}} \right) \\

SD [S] &amp;= \sqrt {\ln \left(1 + \dfrac{\sigma^2}{\mu^2} \right)}
\end{align}\]</span></p>
<p>See <a href="https://en.wikipedia.org/wiki/Log-normal_distribution" class="external-link">“log-normal_distribution” on Wikipedia</a> for a
detailed explanation of this parametrisation.</p>
<p>We will now set up the serial interval function with the appropriate inputs.
We adopt R’s random lognormal distribution generator (<code><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm()</a></code>) that
takes <code>meanlog</code> and <code>sdlog</code> as arguments, which we define with the
parametrisation above as <code>log_mean()</code> and <code>log_sd()</code> respectively and wrap it in
the <code>serial_interval()</code> function. Moreover, <code>serial_interval()</code> takes one
argument <code>sample_size</code> as is required by <em>bpmodels</em>
(See <code><a href="../reference/chain_sim.html">?bpmodels::chain_sim</a></code>), which is further passed to <code><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm()</a></code> as the
first argument to determine the number of observations to sample
(See <code><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">?rlnorm</a></code>).</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mu</span> <span class="op">&lt;-</span> <span class="fl">4.7</span></span>
<span><span class="va">sgma</span> <span class="op">&lt;-</span> <span class="fl">2.9</span></span>
<span></span>
<span><span class="va">log_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="op">(</span><span class="va">mu</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sgma</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">mu</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>  <span class="co"># log mean</span></span>
<span><span class="va">log_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="va">sgma</span> <span class="op">/</span> <span class="va">mu</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="co"># log sd</span></span>
<span></span>
<span><span class="co">#' serial interval function</span></span>
<span><span class="va">serial_interval</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">si</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="va">sample_size</span>, meanlog <span class="op">=</span> <span class="va">log_mean</span>, sdlog <span class="op">=</span> <span class="va">log_sd</span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">si</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</details>
</div>
<div class="section level3">
<h3 id="offspring-distribution">Offspring distribution<a class="anchor" aria-label="anchor" href="#offspring-distribution"></a>
</h3>
<p>The negative binomial distribution is commonly used in epidemiology to
account for individual variation in transmissibility,
also known as superspreading <span class="citation">(<a href="#ref-lloyd-smith2005" role="doc-biblioref">Lloyd-Smith et al. 2005</a>)</span>.</p>
<p>For this example, we will assume that the offspring distribution is
characterised by a negative binomial with <span class="math inline">\(R = 2.5\)</span> <span class="citation">(<a href="#ref-abbott2020" role="doc-biblioref">Abbott et al. 2020</a>)</span> and
<span class="math inline">\(k = 0.58\)</span> <span class="citation">(<a href="#ref-wang2020" role="doc-biblioref">Wang et al. 2020</a>)</span>. In this parameterization, <span class="math inline">\(R\)</span>
represents the <span class="math inline">\(R_0\)</span>, which is defined as the average number of
cases produced by a single individual in an entirely susceptible population.
The parameter <span class="math inline">\(k\)</span> represents superspreading, that is, the degree of
heterogeneity in transmission by single individuals.</p>
</div>
<div class="section level3">
<h3 id="simulation-controls">Simulation controls<a class="anchor" aria-label="anchor" href="#simulation-controls"></a>
</h3>
<p><code><a href="../reference/chain_sim.html">chain_sim()</a></code> also requires the end time for the simulations. For this
example, we will simulate outbreaks that end 14 days after the last date
of observations in <code>covid19_sa</code>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Date to end simulation (14 day projection in this case)</span></span>
<span><span class="va">projection_window</span> <span class="op">&lt;-</span> <span class="fl">14</span> <span class="co"># 14 days/ 2-week ahead projection</span></span>
<span><span class="va">projection_end_day</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">days_since_index</span><span class="op">)</span> <span class="op">+</span> <span class="va">projection_window</span></span>
<span><span class="va">projection_end_day</span></span>
<span><span class="co">#&gt; [1] 29</span></span></code></pre></div>
</details><p><code><a href="../reference/chain_sim.html">chain_sim()</a></code> is stochastic, meaning the results are different every
time it is run for the same set of parameters, so we will run the simulations
many times and summarise the results.</p>
<p>We will, therefore, run each simulation <span class="math inline">\(100\)</span> times.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Number of simulations</span></span>
<span><span class="va">sim_rep</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></code></pre></div>
</details><p>Lastly, <code><a href="../reference/chain_sim.html">chain_sim()</a></code> requires the maximum size of each chain.
Above this value, the simulation is cut off. If this value is
not specified, it assumes a value of infinity. Here, we will
assume a maximum chain size of <span class="math inline">\(1000\)</span>. We will call it <code>chain_threhold</code>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' Maximum chain size allowed</span></span>
<span><span class="va">chain_threshold</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></code></pre></div>
</details>
</div>
</div>
<div class="section level2">
<h2 id="modelling-assumptions">Modelling assumptions<a class="anchor" aria-label="anchor" href="#modelling-assumptions"></a>
</h2>
<p><code><a href="../reference/chain_sim.html">chain_sim()</a></code> makes the following simplifying assumptions:</p>
<ol style="list-style-type: decimal">
<li>All cases are observed</li>
<li>There is no reporting delay</li>
<li>Reporting rate is constant through the course of the epidemic</li>
<li>No interventions have been implemented</li>
<li>Population is homogeneous and well-mixed</li>
</ol>
<p>To summarise the whole set up so far, we are going to simulate
each chain 100 times, projecting COVID-19 cases over
14 days after the first <span class="math inline">\(15\)</span> days, and
assuming that no outbreak size exceeds 1000 cases.</p>
</div>
<div class="section level2">
<h2 id="running-the-simulations">Running the simulations<a class="anchor" aria-label="anchor" href="#running-the-simulations"></a>
</h2>
<p>We will use the function <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply()</a></code> to run the simulations and bind them
by rows with <code><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">dplyr::bind_rows()</a></code>.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">sim_chain_sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">sim_rep</span><span class="op">)</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/chain_sim.html">chain_sim</a></span><span class="op">(</span></span>
<span>      n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">start_times</span><span class="op">)</span>,</span>
<span>      offspring <span class="op">=</span> <span class="st">"nbinom"</span>,</span>
<span>      mu <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">0.58</span>,</span>
<span>      stat <span class="op">=</span> <span class="st">"size"</span>,</span>
<span>      infinite <span class="op">=</span> <span class="va">chain_threshold</span>,</span>
<span>      serial <span class="op">=</span> <span class="va">serial_interval</span>,</span>
<span>      t0 <span class="op">=</span> <span class="va">start_times</span>,</span>
<span>      tf <span class="op">=</span> <span class="va">projection_end_day</span>,</span>
<span>      tree <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sim <span class="op">=</span> <span class="va">sim</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">sim_chain_sizes</span><span class="op">)</span></span></code></pre></div>
</details><p>Let us view the first few rows of the simulation results.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sim_output</span><span class="op">)</span></span>
<span><span class="co">#&gt;   n id ancestor generation time sim</span></span>
<span><span class="co">#&gt; 1 1  1       NA          1    0   1</span></span>
<span><span class="co">#&gt; 2 2  1       NA          1    2   1</span></span>
<span><span class="co">#&gt; 3 3  1       NA          1    3   1</span></span>
<span><span class="co">#&gt; 4 4  1       NA          1    4   1</span></span>
<span><span class="co">#&gt; 5 5  1       NA          1    4   1</span></span>
<span><span class="co">#&gt; 6 6  1       NA          1    4   1</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="post-processing">Post-processing<a class="anchor" aria-label="anchor" href="#post-processing"></a>
</h2>
<p>Now, we will summarise the simulation results.</p>
<p>We want to plot the individual simulated daily time series and show
the median cases per day aggregated over all simulations.</p>
<p>First, we will create the daily time series per simulation by
aggregating the number of cases per day of each simulation.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Daily number of cases for each simulation</span></span>
<span><span class="va">incidence_ts</span> <span class="op">&lt;-</span> <span class="va">sim_output</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sim</span>, <span class="va">day</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">incidence_ts</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;     sim   day cases</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     0     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1     2     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1     3     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1     4     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1     6     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1     7     4</span></span></code></pre></div>
</details><p>Next, we will add a date column to the results of each simulation
set. We will use the date of the first case in the observed data
as the reference start date.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get start date from the observed data</span></span>
<span><span class="va">index_date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">covid19_sa</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="va">index_date</span></span>
<span><span class="co">#&gt; [1] "2020-03-05"</span></span>
<span></span>
<span><span class="co"># Add a dates column to each simulation result</span></span>
<span><span class="va">incidence_ts_by_date</span> <span class="op">&lt;-</span> <span class="va">incidence_ts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">index_date</span> <span class="op">+</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/period.html" class="external-link">days</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;     sim   day cases date      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1     0     1 2020-03-05</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1     2     1 2020-03-06</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     1     3     1 2020-03-07</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>     1     4     4 2020-03-08</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>     1     6     6 2020-03-09</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>     1     7     4 2020-03-10</span></span></code></pre></div>
</details><p>Now we will aggregate the simulations by day and evaluate the median
daily cases across all simulations.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Median daily number of cases aggregated across all simulations</span></span>
<span><span class="va">median_daily_cases</span> <span class="op">&lt;-</span> <span class="va">incidence_ts_by_date</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>median_cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">median_daily_cases</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 2</span></span></span>
<span><span class="co">#&gt;   date       median_cases</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2020-03-05          1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2020-03-06          1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2020-03-07          1  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 2020-03-08          4  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2020-03-09          3.5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2020-03-10          8</span></span></code></pre></div>
</details>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>We will now plot the individual simulation results alongside the median
of the aggregated results.</p>
<details class="chunk-details" open><summary class="chunk-summary"><span class="chunk-summary-text">Code</span></summary><div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">incidence_ts_by_date</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date</span>,</span>
<span>      y <span class="op">=</span> <span class="va">cases</span>,</span>
<span>      group <span class="op">=</span> <span class="va">sim</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">median_daily_cases</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date</span>,</span>
<span>      y <span class="op">=</span> <span class="va">median_cases</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"tomato3"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1.8</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">covid19_sa</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date</span>,</span>
<span>      y <span class="op">=</span> <span class="va">cases</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">1.75</span>,</span>
<span>    shape <span class="op">=</span> <span class="fl">21</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">covid19_sa</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">date</span>,</span>
<span>      y <span class="op">=</span> <span class="va">cases</span></span>
<span>    <span class="op">)</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      <span class="fl">5</span></span>
<span>    <span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      <span class="fl">5</span></span>
<span>    <span class="op">)</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">date</span><span class="op">)</span> <span class="op">-</span> <span class="fl">4</span> <span class="co"># for a better visual look</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      <span class="fl">0</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span> <span class="op">+</span> <span class="fl">200</span>,</span>
<span>      <span class="fl">250</span></span>
<span>    <span class="op">)</span>,</span>
<span>    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span></span>
<span>      <span class="fl">0</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">incidence_ts_by_date</span><span class="op">$</span><span class="va">cases</span><span class="op">)</span> <span class="op">+</span> <span class="fl">200</span>,</span>
<span>      <span class="fl">250</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span></span>
<span>    mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">covid19_sa</span><span class="op">$</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Daily cases"</span><span class="op">)</span></span></code></pre></div>
</details><div class="figure">
<span style="display:block;" id="fig:viz"></span>
<img src="projecting_incidence_files/figure-html/viz-1.png" alt="COVID-19 incidence in South Africa projected over a two week window in 2020. The light gray lines represent the individual simulations, the red line represents the median daily cases across all simulations, the black connected dots represent the observed data, and the dashed vertical line marks the beginning of the projection."><p class="caption">
Figure 1: COVID-19 incidence in South Africa projected over a two week window in 2020. The light gray lines represent the individual simulations, the red line represents the median daily cases across all simulations, the black connected dots represent the observed data, and the dashed vertical line marks the beginning of the projection.
</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-abbott2020" class="csl-entry">
Abbott, Sam, Joel Hellewell, James Munday, Sebastian Funk, CMMID nCoV working group, et al. 2020. <span>“The Transmissibility of Novel Coronavirus in the Early Stages of the 2019-20 Outbreak in Wuhan: Exploring Initial Point-Source Exposure Sizes and Durations Using Scenario Analysis.”</span> <em>Wellcome Open Research</em> 5.
</div>
<div id="ref-limpert2001" class="csl-entry">
Limpert, Eckhard, Werner A. Stahel, and Markus Abbt. 2001. <span>“Log-Normal Distributions Across the Sciences: Keys and Clues.”</span> <em>BioScience</em> 51 (5): 341–52. <a href="https://doi.org/10.1641/0006-3568(2001)051%5B0341:LNDATS%5D2.0.CO;2" class="external-link">https://doi.org/10.1641/0006-3568(2001)051[0341:LNDATS]2.0.CO;2</a>.
</div>
<div id="ref-lloyd-smith2005" class="csl-entry">
Lloyd-Smith, J. O., S. J. Schreiber, P. E. Kopp, and W. M. Getz. 2005. <span>“Superspreading and the Effect of Individual Variation on Disease Emergence.”</span> <em>Nature</em> 438 (7066): 355–59. <a href="https://doi.org/10.1038/nature04153" class="external-link">https://doi.org/10.1038/nature04153</a>.
</div>
<div id="ref-marivate2020" class="csl-entry">
Marivate, Vukosi, and Herkulaas MvE Combrink. 2020. <span>“Use of Available Data to Inform the COVID-19 Outbreak in South Africa: A Case Study.”</span> <em>arXiv Preprint arXiv:2004.04813</em>.
</div>
<div id="ref-nishiura2007" class="csl-entry">
Nishiura, Hiroshi. 2007. <span>“Early Efforts in Modeling the Incubation Period of Infectious Diseases with an Acute Course of Illness.”</span> <em>Emerging Themes in Epidemiology</em> 4: 1–12. <a href="https://doi.org/10.1186/1742-7622-4-2" class="external-link">https://doi.org/10.1186/1742-7622-4-2</a>.
</div>
<div id="ref-pearson2020" class="csl-entry">
Pearson, Carl A.B., Cari van Schalkwyk, Anna M. Foss, Kathleen M. O’Reilly, and Juliet R.C. Pulliam. 2020. <span>“Projected Early Spread of COVID-19 in Africa Through 1 June 2020.”</span> <em>Eurosurveillance</em> 25 (18): 1–6. <a href="https://doi.org/10.2807/1560-7917.ES.2020.25.18.2000543" class="external-link">https://doi.org/10.2807/1560-7917.ES.2020.25.18.2000543</a>.
</div>
<div id="ref-wang2020" class="csl-entry">
Wang, Liang, Xavier Didelot, Jing Yang, Gary Wong, Yi Shi, Wenjun Liu, George F. Gao, and Yuhai Bi. 2020. <span>“Inference of Person-to-Person Transmission of COVID-19 Reveals Hidden Super-Spreading Events During the Early Outbreak Phase.”</span> <em>Nature Communications</em> 11 (1): 1–6. <a href="https://doi.org/10.1038/s41467-020-18836-4" class="external-link">https://doi.org/10.1038/s41467-020-18836-4</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by James M. Azam, Flavio Finger, Sebastian Funk.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
